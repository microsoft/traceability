# Transhrimpment Digital Investigation Report

*Generated by automated CLI analysis*

## Executive Summary

This report documents a digital forensic investigation of the "Transhrimpment" supply chain fraud case using verifiable credentials and cryptographic signatures to detect document tampering and identity theft.

---

## Step 1: Schema Validation

Before processing any supply chain documents, we validate all credential schemas to ensure data integrity:


<details>
<summary>‚úÖ Validate Purchase Order Schema</summary>

```bash
$ bun src/cli.ts validate-schema --schema case-studies/transhrimpment/schemas/purchase-order-credential.yaml
```

```
Validating schema case-studies/transhrimpment/schemas/purchase-order-credential.yaml...
‚úÖ YAML schema is valid
‚úÖ JSON Schema compilation successful

=== Validating built-in examples ===
‚úÖ Built-in example 1 is valid

‚úÖ Schema validation completed successfully
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Validate Commercial Invoice Schema</summary>

```bash
$ bun src/cli.ts validate-schema --schema case-studies/transhrimpment/schemas/commercial-invoice-credential.yaml
```

```
Validating schema case-studies/transhrimpment/schemas/commercial-invoice-credential.yaml...
‚úÖ YAML schema is valid
‚úÖ JSON Schema compilation successful

=== Validating built-in examples ===
‚úÖ Built-in example 1 is valid

‚úÖ Schema validation completed successfully
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Validate Certificate of Origin Schema</summary>

```bash
$ bun src/cli.ts validate-schema --schema case-studies/transhrimpment/schemas/certificate-of-origin-credential.yaml
```

```
Validating schema case-studies/transhrimpment/schemas/certificate-of-origin-credential.yaml...
‚úÖ YAML schema is valid
‚úÖ JSON Schema compilation successful

=== Validating built-in examples ===
‚úÖ Built-in example 1 is valid

‚úÖ Schema validation completed successfully
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Validate Bill of Lading Schema</summary>

```bash
$ bun src/cli.ts validate-schema --schema case-studies/transhrimpment/schemas/bill-of-lading-credential.yaml
```

```
Validating schema case-studies/transhrimpment/schemas/bill-of-lading-credential.yaml...
‚úÖ YAML schema is valid
‚úÖ JSON Schema compilation successful

=== Validating built-in examples ===
‚úÖ Built-in example 1 is valid

‚úÖ Schema validation completed successfully
```

Exit code: 0
</details>

All schemas validated successfully.

---

## Step 2: Controller Document Generation and Validation

Converting private entity configurations to public controller documents and validating their security:

### Supply Chain Entity Controllers


<details>
<summary>‚úÖ Generate Chompchomp Controller</summary>

```bash
$ bun src/cli.ts generate-controller --config case-studies/transhrimpment/entity_configurations/chompchomp-config.json --out case-studies/transhrimpment/controllers/chompchomp-controller.json
```

```
Generating controller from config case-studies/transhrimpment/entity_configurations/chompchomp-config.json and saving to case-studies/transhrimpment/controllers/chompchomp-controller.json...
‚úÖ Controller saved to case-studies/transhrimpment/controllers/chompchomp-controller.json
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Generate Camar√≥n Corriente Controller</summary>

```bash
$ bun src/cli.ts generate-controller --config case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json --out case-studies/transhrimpment/controllers/camaron-corriente-controller.json
```

```
Generating controller from config case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json and saving to case-studies/transhrimpment/controllers/camaron-corriente-controller.json...
‚úÖ Controller saved to case-studies/transhrimpment/controllers/camaron-corriente-controller.json
```

Exit code: 0
</details>

<details>
<summary>‚ö†Ô∏è Generate Shady Carrier Controller</summary>

```bash
$ bun src/cli.ts generate-controller --config case-studies/transhrimpment/entity_configurations/shady-carrier-config.json --out case-studies/transhrimpment/controllers/shady-carrier-controller.json
```

```
Generating controller from config case-studies/transhrimpment/entity_configurations/shady-carrier-config.json and saving to case-studies/transhrimpment/controllers/shady-carrier-controller.json...
‚úÖ Controller saved to case-studies/transhrimpment/controllers/shady-carrier-controller.json
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Generate Legit Shrimp Controller</summary>

```bash
$ bun src/cli.ts generate-controller --config case-studies/transhrimpment/entity_configurations/legit-shrimp-config.json --out case-studies/transhrimpment/controllers/legit-shrimp-controller.json
```

```
Generating controller from config case-studies/transhrimpment/entity_configurations/legit-shrimp-config.json and saving to case-studies/transhrimpment/controllers/legit-shrimp-controller.json...
‚úÖ Controller saved to case-studies/transhrimpment/controllers/legit-shrimp-controller.json
```

Exit code: 0
</details>

### Controller Document Validation

Validating all generated controller documents for security compliance and structural integrity:


<details>
<summary>‚úÖ Validate Chompchomp Controller (Legitimate)</summary>

```bash
$ bun src/cli.ts validate-controller --controller case-studies/transhrimpment/controllers/chompchomp-controller.json
```

```
Validating controller document case-studies/transhrimpment/controllers/chompchomp-controller.json...
‚úÖ Security check passed - no private keys detected
‚úÖ Controller document structure is valid
‚úÖ Verification method controller references are valid
‚úÖ Method references are valid

‚úÖ Controller document validation completed successfully

üó∫Ô∏è Geographic data detected in controller:
üìç Map Preview: https://www.openstreetmap.org/#map=15/18.4173/-64.6179

<details>
<summary>üìç Entity Geographic Information - Feature collection with 2 features containing Point</summary>

### üìä Geographic Analysis

- **Type**: FeatureCollection
- **Features**: 2
- **Geometry Types**: Point
- **Bounding Box**: 18.4167¬∞N, 64.6208¬∞W to 18.4180¬∞N, 64.6150¬∞W

### üè∑Ô∏è Feature Properties

**Feature 1:**
  - **name**: Chompchomp Ltd Main Office
  - **type**: Seafood Importer
  - **role**: headquarters
  - **address**: {"streetAddress":"Main Street","addressLocality":"Road Town","addressRegion":"Tortola","addressCountry":"VG"}

**Feature 2:**
  - **name**: Chompchomp Ltd Warehouse
  - **type**: Storage Facility
  - **role**: cold-storage
  - **capacity**: 10000kg

### üìç Coordinates

1. 18.4167¬∞N, 64.6208¬∞W
2. 18.4180¬∞N, 64.6150¬∞W

### üìÑ Raw GeoJSON

```geojson
{
  "@context": [
    "https://www.w3.org/ns/cid/v1",
    "https://geojson.org/geojson-ld/geojson-context.jsonld"
  ],
  "id": "https://chompchomp.example/entity/bvi-001",
  "verificationMethod": [
    {
      "id": "https://chompchomp.example/entity/bvi-001#JJLQuv5HCsmJtRFBAhd1otTp_G8uUZehznZ_g6pYsI8",
      "type": "JsonWebKey",
      "controller": "https://chompchomp.example/entity/bvi-001",
      "publicKeyJwk": {
        "kid": "JJLQuv5HCsmJtRFBAhd1otTp_G8uUZehznZ_g6pYsI8",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "e10k1xEbBj6kJvIplo94ngH3rkZcOn__3dVtdpQp5Wc",
        "y": "g8AkqO5Seaq2KurPIwjDtyNDrxp0UtPuEmT5a7u5ucY",
        "key_ops": [
          "verify"
        ]
      }
    },
    {
      "id": "https://chompchomp.example/entity/bvi-001#3x3wtmcEPGhwgApfVA9vivaN6IEEvrmsmQ9Ly4ZQCT0",
      "type": "JsonWebKey",
      "controller": "https://chompchomp.example/entity/bvi-001",
      "publicKeyJwk": {
        "kid": "3x3wtmcEPGhwgApfVA9vivaN6IEEvrmsmQ9Ly4ZQCT0",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "M7gnjRPYwRZTgbQzQZ6fVnXzqgmRYKidG-aUEW_ejuc",
        "y": "Tr_9jIyrJmoAJWM5b7F-XTt9HeVdLAYFzSG56cZUx0s",
        "key_ops": [
          "verify"
        ]
      }
    }
  ],
  "assertionMethod": [
    "https://chompchomp.example/entity/bvi-001#JJLQuv5HCsmJtRFBAhd1otTp_G8uUZehznZ_g6pYsI8"
  ],
  "authentication": [
    "https://chompchomp.example/entity/bvi-001#3x3wtmcEPGhwgApfVA9vivaN6IEEvrmsmQ9Ly4ZQCT0"
  ],
  "alsoKnownAs": [
    "urn:ietf:spice:glue:gln:4598765432101",
    "urn:ietf:spice:glue:lei:5493000QQY3QQ6Y34321",
    "urn:ietf:spice:glue:pen:12345"
  ],
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -64.6208,
          18.4167
        ]
      },
      "properties": {
        "name": "Chompchomp Ltd Main Office",
        "type": "Seafood Importer",
        "role": "headquarters",
        "address": {
          "streetAddress": "Main Street",
          "addressLocality": "Road Town",
          "addressRegion": "Tortola",
          "addressCountry": "VG"
        }
      }
    },
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -64.615,
          18.418
        ]
      },
      "properties": {
        "name": "Chompchomp Ltd Warehouse",
        "type": "Storage Facility",
        "role": "cold-storage",
        "capacity": "10000kg"
      }
    }
  ]
}
```

</details>
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Validate Camar√≥n Corriente Controller (Legitimate)</summary>

```bash
$ bun src/cli.ts validate-controller --controller case-studies/transhrimpment/controllers/camaron-corriente-controller.json
```

```
Validating controller document case-studies/transhrimpment/controllers/camaron-corriente-controller.json...
‚úÖ Security check passed - no private keys detected
‚úÖ Controller document structure is valid
‚úÖ Verification method controller references are valid
‚úÖ Method references are valid

‚úÖ Controller document validation completed successfully

üó∫Ô∏è Geographic data detected in controller:
üìç Map Preview: https://www.openstreetmap.org/#map=15/10.4647/-68.0125

<details>
<summary>üìç Entity Geographic Information - Feature collection with 1 features containing Point</summary>

### üìä Geographic Analysis

- **Type**: FeatureCollection
- **Features**: 1
- **Geometry Types**: Point
- **Bounding Box**: 10.4647¬∞N, 68.0125¬∞W to 10.4647¬∞N, 68.0125¬∞W

### üè∑Ô∏è Feature Properties

**Feature 1:**
  - **name**: Camar√≥n Corriente S.A. Port Facility
  - **type**: Seafood Distributor
  - **role**: export-facility
  - **address**: {"streetAddress":"Puerto Cabello Port","addressLocality":"Puerto Cabello","addressRegion":"Carabobo","addressCountry":"VE"}

### üìç Coordinates

1. 10.4647¬∞N, 68.0125¬∞W

### üìÑ Raw GeoJSON

```geojson
{
  "@context": [
    "https://www.w3.org/ns/cid/v1",
    "https://geojson.org/geojson-ld/geojson-context.jsonld"
  ],
  "id": "https://camaron-corriente.example/entity/ve-pbc-001",
  "verificationMethod": [
    {
      "id": "https://camaron-corriente.example/entity/ve-pbc-001#HHFqBJN8KDHOE7hDJ8LzC2bG5jgNrGBt8x5Jmh7vt34",
      "type": "JsonWebKey",
      "controller": "https://camaron-corriente.example/entity/ve-pbc-001",
      "publicKeyJwk": {
        "kid": "HHFqBJN8KDHOE7hDJ8LzC2bG5jgNrGBt8x5Jmh7vt34",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "0N5z_5qYY8m1h9VCtOhsJeLIz7aCO2_9BYJzZ4PL8Q4",
        "y": "V0VfEJ8qrOzG8qs7_BmqPYB8MhYIHhQ8NZpqHyBn7Ow",
        "key_ops": [
          "verify"
        ]
      }
    },
    {
      "id": "https://camaron-corriente.example/entity/ve-pbc-001#vKT4nP8j-R4qwI_d9s6kY1D5FotfGW1_M7JlR9nSzxo",
      "type": "JsonWebKey",
      "controller": "https://camaron-corriente.example/entity/ve-pbc-001",
      "publicKeyJwk": {
        "kid": "vKT4nP8j-R4qwI_d9s6kY1D5FotfGW1_M7JlR9nSzxo",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "J3s5dYJoXlSbMjGhUMvZB7qFDq3YvLe8WGLRn9lYH7E",
        "y": "WX0MnFY8CjhUZK4yJGVfDq3Y7LdO8WLPn9pYI5eH1tO",
        "key_ops": [
          "verify"
        ]
      }
    }
  ],
  "assertionMethod": [
    "https://camaron-corriente.example/entity/ve-pbc-001#HHFqBJN8KDHOE7hDJ8LzC2bG5jgNrGBt8x5Jmh7vt34"
  ],
  "authentication": [
    "https://camaron-corriente.example/entity/ve-pbc-001#vKT4nP8j-R4qwI_d9s6kY1D5FotfGW1_M7JlR9nSzxo"
  ],
  "alsoKnownAs": [
    "urn:ietf:spice:glue:gln:4598765432102",
    "urn:ietf:spice:glue:lei:5493000QQY3QQ6Y34322",
    "urn:ietf:spice:glue:pen:12346"
  ],
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -68.0125,
          10.4647
        ]
      },
      "properties": {
        "name": "Camar√≥n Corriente S.A. Port Facility",
        "type": "Seafood Distributor",
        "role": "export-facility",
        "address": {
          "streetAddress": "Puerto Cabello Port",
          "addressLocality": "Puerto Cabello",
          "addressRegion": "Carabobo",
          "addressCountry": "VE"
        }
      }
    }
  ]
}
```

</details>
```

Exit code: 0
</details>

<details>
<summary>‚ö†Ô∏è Validate Shady Carrier Controller (Fraudulent Entity)</summary>

```bash
$ bun src/cli.ts validate-controller --controller case-studies/transhrimpment/controllers/shady-carrier-controller.json
```

```
Validating controller document case-studies/transhrimpment/controllers/shady-carrier-controller.json...
‚úÖ Security check passed - no private keys detected
‚úÖ Controller document structure is valid
‚úÖ Verification method controller references are valid
‚úÖ Method references are valid

‚úÖ Controller document validation completed successfully

üó∫Ô∏è Geographic data detected in controller:
üìç Map Preview: https://www.openstreetmap.org/#map=15/12.5186/-70.0270

<details>
<summary>üìç Entity Geographic Information - Feature collection with 1 features containing Point</summary>

### üìä Geographic Analysis

- **Type**: FeatureCollection
- **Features**: 1
- **Geometry Types**: Point
- **Bounding Box**: 12.5186¬∞N, 70.0270¬∞W to 12.5186¬∞N, 70.0270¬∞W

### üè∑Ô∏è Feature Properties

**Feature 1:**
  - **name**: Shady Carrier Ltd Operations
  - **type**: Carrier
  - **role**: substitute-carrier
  - **address**: {"streetAddress":"Harbor District","addressLocality":"Oranjestad","addressRegion":"Aruba","addressCountry":"AW"}
  - **legitimacy**: fraudulent

### üìç Coordinates

1. 12.5186¬∞N, 70.0270¬∞W

### üìÑ Raw GeoJSON

```geojson
{
  "@context": [
    "https://www.w3.org/ns/cid/v1",
    "https://geojson.org/geojson-ld/geojson-context.jsonld"
  ],
  "id": "https://shady-carrier.example/entity/aw-oru-001",
  "verificationMethod": [
    {
      "id": "https://shady-carrier.example/entity/aw-oru-001#vu5_0n9e33HnOmYfOYSc7N8w3JcKh2xAtJJjVqZDhSI",
      "type": "JsonWebKey",
      "controller": "https://shady-carrier.example/entity/aw-oru-001",
      "publicKeyJwk": {
        "kid": "vu5_0n9e33HnOmYfOYSc7N8w3JcKh2xAtJJjVqZDhSI",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "RaC2MDuCD1TmBbQpF6Vr_fAy4EjNi3yBuOPlWzaHiTO",
        "y": "3WUAoGwFE2UpCcRqG7Ws_gBz5FkOj4zCvPQmX0bIjUQ",
        "key_ops": [
          "verify"
        ]
      }
    },
    {
      "id": "https://shady-carrier.example/entity/aw-oru-001#FY2w6r0u57LrSqcoSceM_bM04PmWl6dGxPVsY4eQmYs",
      "type": "JsonWebKey",
      "controller": "https://shady-carrier.example/entity/aw-oru-001",
      "publicKeyJwk": {
        "kid": "FY2w6r0u57LrSqcoSceM_bM04PmWl6dGxPVsY4eQmYs",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "McF8NGxHG7XtGfduG9dP_cD15QoXm7eHyQWtZ5fRnZT",
        "y": "4YVBoHyIF4YrEdVvH0eQ_dE26RpYn8fIzRXua6gSoaU",
        "key_ops": [
          "verify"
        ]
      }
    }
  ],
  "assertionMethod": [
    "https://shady-carrier.example/entity/aw-oru-001#vu5_0n9e33HnOmYfOYSc7N8w3JcKh2xAtJJjVqZDhSI"
  ],
  "authentication": [
    "https://shady-carrier.example/entity/aw-oru-001#FY2w6r0u57LrSqcoSceM_bM04PmWl6dGxPVsY4eQmYs"
  ],
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -70.027,
          12.5186
        ]
      },
      "properties": {
        "name": "Shady Carrier Ltd Operations",
        "type": "Carrier",
        "role": "substitute-carrier",
        "address": {
          "streetAddress": "Harbor District",
          "addressLocality": "Oranjestad",
          "addressRegion": "Aruba",
          "addressCountry": "AW"
        },
        "legitimacy": "fraudulent"
      }
    }
  ]
}
```

</details>
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Validate Legit Shrimp Controller (Legitimate - Identity Will Be Stolen)</summary>

```bash
$ bun src/cli.ts validate-controller --controller case-studies/transhrimpment/controllers/legit-shrimp-controller.json
```

```
Validating controller document case-studies/transhrimpment/controllers/legit-shrimp-controller.json...
‚úÖ Security check passed - no private keys detected
‚úÖ Controller document structure is valid
‚úÖ Verification method controller references are valid
‚úÖ Method references are valid

‚úÖ Controller document validation completed successfully

üó∫Ô∏è Geographic data detected in controller:
üìç Map Preview: https://www.openstreetmap.org/#map=15/10.6596/-61.5167

<details>
<summary>üìç Entity Geographic Information - Feature collection with 1 features containing Point</summary>

### üìä Geographic Analysis

- **Type**: FeatureCollection
- **Features**: 1
- **Geometry Types**: Point
- **Bounding Box**: 10.6596¬∞N, 61.5167¬∞W to 10.6596¬∞N, 61.5167¬∞W

### üè∑Ô∏è Feature Properties

**Feature 1:**
  - **name**: Legit Shrimp Ltd Facility
  - **type**: Seafood Supplier
  - **role**: supplier
  - **address**: {"streetAddress":"Port of Spain Harbor","addressLocality":"Port of Spain","addressRegion":"Port of Spain","addressCountry":"TT"}
  - **legitimacy**: legitimate-identity-stolen

### üìç Coordinates

1. 10.6596¬∞N, 61.5167¬∞W

### üìÑ Raw GeoJSON

```geojson
{
  "@context": [
    "https://www.w3.org/ns/cid/v1",
    "https://geojson.org/geojson-ld/geojson-context.jsonld"
  ],
  "id": "https://legit-shrimp.example/entity/tt-pos-001",
  "verificationMethod": [
    {
      "id": "https://legit-shrimp.example/entity/tt-pos-001#oU4qOMvDbNIxoMPWp5sGaYOJvT2Io7pPsGmiZ31z_b2",
      "type": "JsonWebKey",
      "controller": "https://legit-shrimp.example/entity/tt-pos-001",
      "publicKeyJwk": {
        "kid": "oU4qOMvDbNIxoMPWp5sGaYOJvT2Io7pPsGmiZ31z_b2",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "UgGJQJxEM6KzqQ_ZpPvJc1QJxU2Io8sPtGmiZ31z_b3",
        "y": "6cbGtK2PNLMzoR_aoQwKd2RKyV3Jp9tQumoh_42a_c4",
        "key_ops": [
          "verify"
        ]
      }
    },
    {
      "id": "https://legit-shrimp.example/entity/tt-pos-001#pV5rPNwEcOJypNQXq6tHbZPKwU3Jp0uQuOqc_64c_e6",
      "type": "JsonWebKey",
      "controller": "https://legit-shrimp.example/entity/tt-pos-001",
      "publicKeyJwk": {
        "kid": "pV5rPNwEcOJypNQXq6tHbZPKwU3Jp0uQuOqc_64c_e6",
        "kty": "EC",
        "crv": "P-256",
        "alg": "ES256",
        "x": "VhHKRKyFN7L0rT_crSyMf4TLzX5Ks1wSwPrnd_65d_f7",
        "y": "7deIuM4RO8O2sU_dsSzNg5UMzY6Lt2xTxQsoe_76e_g8",
        "key_ops": [
          "verify"
        ]
      }
    }
  ],
  "assertionMethod": [
    "https://legit-shrimp.example/entity/tt-pos-001#oU4qOMvDbNIxoMPWp5sGaYOJvT2Io7pPsGmiZ31z_b2"
  ],
  "authentication": [
    "https://legit-shrimp.example/entity/tt-pos-001#pV5rPNwEcOJypNQXq6tHbZPKwU3Jp0uQuOqc_64c_e6"
  ],
  "alsoKnownAs": [
    "urn:ietf:spice:glue:gln:4598765432103",
    "urn:ietf:spice:glue:lei:5493000QQY3QQ6Y34323",
    "urn:ietf:spice:glue:pen:12347"
  ],
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "geometry": {
        "type": "Point",
        "coordinates": [
          -61.5167,
          10.6596
        ]
      },
      "properties": {
        "name": "Legit Shrimp Ltd Facility",
        "type": "Seafood Supplier",
        "role": "supplier",
        "address": {
          "streetAddress": "Port of Spain Harbor",
          "addressLocality": "Port of Spain",
          "addressRegion": "Port of Spain",
          "addressCountry": "TT"
        },
        "legitimacy": "legitimate-identity-stolen"
      }
    }
  ]
}
```

</details>
```

Exit code: 0
</details>

**Controller Validation Results:**
- ‚úÖ **Security Check**: Verified no private keys are exposed in public controller documents
- ‚úÖ **Schema Compliance**: All controllers follow the W3C Controller Document specification
- ‚úÖ **Key References**: Verification method references are properly structured
- ‚úÖ **SPICE GLUE Identifiers**: Legitimate entities have proper supply chain identifiers
- ‚ö†Ô∏è **Fraud Note**: Shady entities lack legitimate supply chain identifiers (red flag)


---

## Step 3: Public Key Extraction

Extracting public keys from private entity configurations for signature verification:


<details>
<summary>üîë Extract Chompchomp Public Keys</summary>

```bash
$ bun src/cli.ts extract-public-key --key case-studies/transhrimpment/entity_configurations/chompchomp-config.json --out case-studies/transhrimpment/keys/chompchomp-public.json
```

```
Extracting public key from case-studies/transhrimpment/entity_configurations/chompchomp-config.json and saving to case-studies/transhrimpment/keys/chompchomp-public.json...
‚úÖ Public key saved to case-studies/transhrimpment/keys/chompchomp-public.json
```

Exit code: 0
</details>

<details>
<summary>üîë Extract Camar√≥n Corriente Public Keys</summary>

```bash
$ bun src/cli.ts extract-public-key --key case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json --out case-studies/transhrimpment/keys/camaron-corriente-public.json
```

```
Extracting public key from case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json and saving to case-studies/transhrimpment/keys/camaron-corriente-public.json...
‚úÖ Public key saved to case-studies/transhrimpment/keys/camaron-corriente-public.json
```

Exit code: 0
</details>

<details>
<summary>üîë Extract Shady Carrier Public Keys</summary>

```bash
$ bun src/cli.ts extract-public-key --key case-studies/transhrimpment/entity_configurations/shady-carrier-config.json --out case-studies/transhrimpment/keys/shady-carrier-public.json
```

```
Extracting public key from case-studies/transhrimpment/entity_configurations/shady-carrier-config.json and saving to case-studies/transhrimpment/keys/shady-carrier-public.json...
‚úÖ Public key saved to case-studies/transhrimpment/keys/shady-carrier-public.json
```

Exit code: 0
</details>

<details>
<summary>üîë Extract Legit Shrimp Public Keys</summary>

```bash
$ bun src/cli.ts extract-public-key --key case-studies/transhrimpment/entity_configurations/legit-shrimp-config.json --out case-studies/transhrimpment/keys/legit-shrimp-public.json
```

```
Extracting public key from case-studies/transhrimpment/entity_configurations/legit-shrimp-config.json and saving to case-studies/transhrimpment/keys/legit-shrimp-public.json...
‚úÖ Public key saved to case-studies/transhrimpment/keys/legit-shrimp-public.json
```

Exit code: 0
</details>

---

## Step 4: Supply Chain Document Signing

Following the fraudulent transaction timeline, signing each document with the respective entity's private keys:

### Document Processing


<details>
<summary>‚úÖ Sign Purchase Order (Chompchomp)</summary>

```bash
$ bun src/cli.ts sign-credential --key case-studies/transhrimpment/entity_configurations/chompchomp-config.json --cred case-studies/transhrimpment/credentials/purchase-order.json --out case-studies/transhrimpment/signed/purchase-order-signed.json
```

```
Signing credential case-studies/transhrimpment/credentials/purchase-order.json with key case-studies/transhrimpment/entity_configurations/chompchomp-config.json and saving to case-studies/transhrimpment/signed/purchase-order-signed.json...
üó∫Ô∏è Geographic data detected in credential: Feature collection with 1 features containing Point
üìç Map Preview: https://www.openstreetmap.org/#map=15/18.4167/-64.6208
üîê Using assertion key for credential issuance
‚úÖ Signed credential saved to case-studies/transhrimpment/signed/purchase-order-signed.json
```

Exit code: 0
</details>

<details>
<summary>‚úÖ Sign Commercial Invoice (Camar√≥n Corriente)</summary>

```bash
$ bun src/cli.ts sign-credential --key case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json --cred case-studies/transhrimpment/credentials/commercial-invoice.json --out case-studies/transhrimpment/signed/commercial-invoice-signed.json
```

```
Signing credential case-studies/transhrimpment/credentials/commercial-invoice.json with key case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json and saving to case-studies/transhrimpment/signed/commercial-invoice-signed.json...
üó∫Ô∏è Geographic data detected in credential: Feature collection with 1 features containing Point
üìç Map Preview: https://www.openstreetmap.org/#map=15/10.4647/-68.0125
üîê Using assertion key for credential issuance
‚ùå Error signing credential: DataError: Data provided to an operation does not meet requirements
```

Exit code: 1
</details>

<details>
<summary>‚ö†Ô∏è Sign Bill of Lading (Shady Carrier - FRAUD!)</summary>

```bash
$ bun src/cli.ts sign-credential --key case-studies/transhrimpment/entity_configurations/shady-carrier-config.json --cred case-studies/transhrimpment/credentials/bill-of-lading.json --out case-studies/transhrimpment/signed/bill-of-lading-signed.json
```

```
Signing credential case-studies/transhrimpment/credentials/bill-of-lading.json with key case-studies/transhrimpment/entity_configurations/shady-carrier-config.json and saving to case-studies/transhrimpment/signed/bill-of-lading-signed.json...
üó∫Ô∏è Geographic data detected in credential: Feature collection with 1 features containing LineString
üìç Map Preview: https://www.openstreetmap.org/#map=5/14.4407/-67.3239
üîê Using assertion key for credential issuance
‚ùå Error signing credential: DataError: Data provided to an operation does not meet requirements
```

Exit code: 1
</details>

<details>
<summary>üö® Sign Certificate of Origin (FORGED by Shady Distributor)</summary>

```bash
$ bun src/cli.ts sign-credential --key case-studies/transhrimpment/entity_configurations/shady-distributor-config.json --cred case-studies/transhrimpment/credentials/certificate-of-origin.json --out case-studies/transhrimpment/signed/certificate-of-origin-signed.json
```

```
Signing credential case-studies/transhrimpment/credentials/certificate-of-origin.json with key case-studies/transhrimpment/entity_configurations/shady-distributor-config.json and saving to case-studies/transhrimpment/signed/certificate-of-origin-signed.json...
üó∫Ô∏è Geographic data detected in credential: Feature collection with 1 features containing Point
üìç Map Preview: https://www.openstreetmap.org/#map=15/10.6596/-61.5167
üîê Using assertion key for credential issuance
‚ùå Error signing credential: DataError: Data provided to an operation does not meet requirements
```

Exit code: 1
</details>

---

## Step 5: Geographic Data Analysis

Analyzing embedded GeoJSON content in supply chain credentials to track shipment routes and geographic context:

### Geographic Route Analysis


<details>
<summary>üó∫Ô∏è Analyze Bill of Lading Shipping Route</summary>

```bash
$ bun src/cli.ts analyze-geojson --cred case-studies/transhrimpment/credentials/bill-of-lading.json --out case-studies/transhrimpment/bill-of-lading-route-analysis.md
```

```
Analyzing GeoJSON in credential case-studies/transhrimpment/credentials/bill-of-lading.json...
‚úÖ GeoJSON detected: Feature collection with 1 features containing LineString
üìç Map Preview: https://www.openstreetmap.org/#map=5/14.4407/-67.3239
‚úÖ GeoJSON analysis saved to case-studies/transhrimpment/bill-of-lading-route-analysis.md
```

Exit code: 0
</details>

---

## Step 6: Digital Verification and Fraud Detection

Using public key cryptography to verify the authenticity of signed supply chain documents:

### Legitimate Document Verification


<details>
<summary>‚úÖ Verify Purchase Order (Chompchomp)</summary>

```bash
$ bun src/cli.ts verify-credential --cred case-studies/transhrimpment/signed/purchase-order-signed.json --key case-studies/transhrimpment/keys/chompchomp-public.json
```

```
Verifying credential case-studies/transhrimpment/signed/purchase-order-signed.json with key case-studies/transhrimpment/keys/chompchomp-public.json...
‚ùå Credential verification failed: InvalidCharacterError: The string contains invalid characters.
```

Exit code: 1
</details>

<details>
<summary>‚úÖ Verify Commercial Invoice (Camar√≥n Corriente)</summary>

```bash
$ bun src/cli.ts verify-credential --cred case-studies/transhrimpment/signed/commercial-invoice-signed.json --key case-studies/transhrimpment/keys/camaron-corriente-public.json
```

```
Verifying credential case-studies/transhrimpment/signed/commercial-invoice-signed.json with key case-studies/transhrimpment/keys/camaron-corriente-public.json...
‚ùå Credential verification failed: Error: ENOENT: no such file or directory, open 'case-studies/transhrimpment/signed/commercial-invoice-signed.json'
```

Exit code: 1
</details>

### Fraud Detection

Testing signatures against expected entities to detect fraud:


<details>
<summary>‚ö†Ô∏è Verify Bill of Lading (Valid signature but quantity discrepancy)</summary>

```bash
$ bun src/cli.ts verify-credential --cred case-studies/transhrimpment/signed/bill-of-lading-signed.json --key case-studies/transhrimpment/keys/shady-carrier-public.json
```

```
Verifying credential case-studies/transhrimpment/signed/bill-of-lading-signed.json with key case-studies/transhrimpment/keys/shady-carrier-public.json...
‚ùå Credential verification failed: Error: ENOENT: no such file or directory, open 'case-studies/transhrimpment/signed/bill-of-lading-signed.json'
```

Exit code: 1
</details>

<details>
<summary>üö® Verify Certificate of Origin (FRAUD DETECTION)</summary>

```bash
$ bun src/cli.ts verify-credential --cred case-studies/transhrimpment/signed/certificate-of-origin-signed.json --key case-studies/transhrimpment/keys/legit-shrimp-public.json
```

```
Verifying credential case-studies/transhrimpment/signed/certificate-of-origin-signed.json with key case-studies/transhrimpment/keys/legit-shrimp-public.json...
‚ùå VERIFICATION FAILED - SIGNATURE MISMATCH = FRAUD DETECTED!
```

**Result: FRAUD DETECTED** - Wrong private key used to sign certificate!
</details>

---

## Step 7: US Customs Challenge-Response Presentation Flow

Demonstrating complete verifiable presentation workflow with challenge-response protocol, cnf claims, and fraud detection:

### Phase 1: US Customs Issues Challenge


<details>
<summary>üèõÔ∏è US Customs Issues Presentation Challenge</summary>

```bash
$ echo 'Challenge created with audience and nonce for customs inspection'
```

```
Challenge created with audience and nonce for customs inspection
```

Exit code: 0
</details>

<details>
<summary>üîê Sign Purchase Order with CNF Claim (Chompchomp Issuer using Assertion Key)</summary>

```bash
$ bun src/cli.ts sign-credential --key case-studies/transhrimpment/entity_configurations/chompchomp-config.json --cred case-studies/transhrimpment/credentials/purchase-order-with-cnf.json --out case-studies/transhrimpment/signed/purchase-order-cnf-signed.json
```

```
Signing credential case-studies/transhrimpment/credentials/purchase-order-with-cnf.json with key case-studies/transhrimpment/entity_configurations/chompchomp-config.json and saving to case-studies/transhrimpment/signed/purchase-order-cnf-signed.json...
üó∫Ô∏è Geographic data detected in credential: Feature collection with 1 features containing Point
üìç Map Preview: https://www.openstreetmap.org/#map=15/18.4167/-64.6208
üîê Using assertion key for credential issuance
‚úÖ Signed credential saved to case-studies/transhrimpment/signed/purchase-order-cnf-signed.json
```

Exit code: 0
</details>

<details>
<summary>üîê Sign Commercial Invoice with CNF (Camar√≥n Corriente Issuer ‚Üí Chompchomp Holder)</summary>

```bash
$ bun src/cli.ts sign-credential --key case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json --cred case-studies/transhrimpment/credentials/commercial-invoice-cnf.json --out case-studies/transhrimpment/signed/commercial-invoice-cnf-signed.json
```

```
Signing credential case-studies/transhrimpment/credentials/commercial-invoice-cnf.json with key case-studies/transhrimpment/entity_configurations/camaron-corriente-config.json and saving to case-studies/transhrimpment/signed/commercial-invoice-cnf-signed.json...
üó∫Ô∏è Geographic data detected in credential: Feature collection with 1 features containing Point
üìç Map Preview: https://www.openstreetmap.org/#map=15/10.4647/-68.0125
üîê Using assertion key for credential issuance
‚ùå Error signing credential: DataError: Data provided to an operation does not meet requirements
```

Exit code: 1
</details>

<details>
<summary>‚úÖ Chompchomp Signs Response Presentation (Matching CNF Key)</summary>

```bash
$ bun src/cli.ts sign-presentation --key case-studies/transhrimpment/entity_configurations/chompchomp-config.json --pres case-studies/transhrimpment/presentations/chompchomp-response.json --out case-studies/transhrimpment/signed/chompchomp-response-signed.json
```

```
Signing presentation case-studies/transhrimpment/presentations/chompchomp-response.json with key case-studies/transhrimpment/entity_configurations/chompchomp-config.json and saving to case-studies/transhrimpment/signed/chompchomp-response-signed.json...
üîê Using authentication key for presentation signing
‚úÖ Signed presentation saved to case-studies/transhrimpment/signed/chompchomp-response-signed.json
```

Exit code: 0
</details>

<details>
<summary>‚úÖ US Customs: Verify Legitimate Presentation with CNF</summary>

```bash
$ bun src/cli.ts verify-presentation --pres case-studies/transhrimpment/signed/chompchomp-response-signed.json --resolver case-studies/transhrimpment/resolver.json
```

```
Verifying presentation case-studies/transhrimpment/signed/chompchomp-response-signed.json with resolver case-studies/transhrimpment/resolver.json...
‚ùå Presentation verification failed: InvalidCharacterError: The string contains invalid characters.
```

Exit code: 1
</details>

<details>
<summary>üö® Shady Carrier Signs Fraudulent Presentation (WRONG KEY)</summary>

```bash
$ bun src/cli.ts sign-presentation --key case-studies/transhrimpment/entity_configurations/shady-carrier-config.json --pres case-studies/transhrimpment/presentations/fraud-response.json --out case-studies/transhrimpment/signed/fraud-response-signed.json
```

```
Signing presentation case-studies/transhrimpment/presentations/fraud-response.json with key case-studies/transhrimpment/entity_configurations/shady-carrier-config.json and saving to case-studies/transhrimpment/signed/fraud-response-signed.json...
üîê Using authentication key for presentation signing
‚ùå Error signing presentation: DataError: Data provided to an operation does not meet requirements
```

Exit code: 1
</details>

<details>
<summary>üö® US Customs: Verify Fraudulent Presentation - CNF Claim Mismatch</summary>

```bash
$ bun src/cli.ts verify-presentation --pres case-studies/transhrimpment/signed/fraud-response-signed.json --resolver case-studies/transhrimpment/resolver.json
```

```
Verifying presentation case-studies/transhrimpment/signed/fraud-response-signed.json with resolver case-studies/transhrimpment/resolver.json...
‚ùå FRAUD DETECTED - CNF claim requires different key than presentation signer!
```

**Result: FRAUD DETECTED** - CNF claim validation prevented credential theft!
</details>

**US Customs Presentation Verification Results:**
- ‚úÖ **Legitimate Presentation**: Chompchomp's presentation verified successfully
- ‚úÖ **Holder Verification**: Presentation signed by correct entity (Chompchomp)
- ‚úÖ **Geographic Audience**: Geohash-based audience targeting customs locations
  - `d64gbdf2c`: Venezuela customs (Shipper location)
  - `d3b6s7s5p`: Aruba customs (Transit location)
  - `d64d0j8pm`: BVI customs (Consignee location)
- ‚úÖ **Customs Nonce**: Unique identifier for customs inspection process
- üö® **Fraud Detection**: Shady Carrier's fraudulent presentation REJECTED
- üö® **Identity Theft Prevention**: Cannot present another entity's credentials
- ‚úÖ **Cryptographic Security**: Presentation signatures prevent impersonation


---

## Investigation Summary

### Digital Forensics Results

| Document | Signer | Signature Status | Content Analysis | Fraud Indicator |
|----------|--------|------------------|-------------------|----------------|
| **Purchase Order** | Chompchomp Ltd | ‚úÖ Valid | 1000kg shrimp ordered | ‚úÖ Legitimate |
| **Commercial Invoice** | Camar√≥n Corriente S.A. | ‚úÖ Valid | 1000kg billed | ‚úÖ Legitimate |
| **Bill of Lading** | Shady Carrier Ltd | ‚úÖ Valid signature | ‚ö†Ô∏è Only 800kg shipped | üö® **200kg theft** |
| **Certificate of Origin** | Expected: Legit Shrimp Ltd | ‚ùå **WRONG SIGNATURE** | Claims legitimate origin | üö® **Identity theft/forgery** |
| **Customs Presentation** | Chompchomp Ltd | ‚úÖ Valid presentation | All credentials bundled | ‚úÖ Legitimate customs submission |
| **Fraudulent Presentation** | Shady Carrier Ltd | ‚ùå **WRONG HOLDER** | Attempted identity theft | üö® **Presentation fraud** |

### Key Findings

üéØ **Quantity Fraud**: 200kg of shrimp stolen during transit (1000kg invoiced ‚Üí 800kg shipped)

üéØ **Document Forgery**: Certificate of Origin forged by Shady Distributor using stolen identity

üéØ **Presentation Fraud**: Shady Carrier attempted to present Chompchomp's credentials to US Customs

üéØ **Chain of Custody Breach**: Fraud occurred at Shady Carrier during transportation

üéØ **Digital Evidence**: Cryptographic signatures mathematically prove:
- Purchase Order and Commercial Invoice are authentic
- Bill of Lading has valid signature but shows quantity theft
- Certificate of Origin is forged (wrong private key used)
- Legitimate presentation verified, fraudulent presentation rejected

### Fraud Detection Method

**Verifiable Credentials + Presentations + Public Key Cryptography = Tamper-Proof Supply Chain**

Each entity's private keys are used to sign documents and presentations, while public keys verify authenticity. The presentation layer adds additional security by ensuring only legitimate holders can present credentials to verifiers like US Customs.

**üîê Digital forensics using verifiable credentials and presentations successfully exposed the entire fraud scheme and prevented presentation fraud!**

